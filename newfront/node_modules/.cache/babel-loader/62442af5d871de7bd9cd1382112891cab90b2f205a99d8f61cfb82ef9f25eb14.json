{"ast":null,"code":"import _slicedToArray from\"C:/Users/jaime/TFGProto/newfront/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Redirect}from\"react-router-dom\";import UserService from\"../../services/user.service\";import EventBus from\"../../common/EventBus\";import Email from\"./Email\";import Roles from\"./Roles\";import\"../../styles/Profile/Profile.css\";import AuthService from\"../../services/auth.service\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showMessage=_useState4[0],setShowMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),redirect=_useState6[0],setRedirect=_useState6[1];var currentUser=AuthService.getCurrentUser();useEffect(function(){UserService.getUserBoard().then(function(response){setContent(\"Logged\");},function(error){var _content=error.response&&error.response.data&&error.response.data.message||error.message||error.toString();setContent(_content);if(error.response&&error.response.status===401){EventBus.dispatch(\"logout\");}});},[]);var handleEraseStats=function handleEraseStats(){var confirmed=window.confirm(\"¿Estás seguro? Se borrarán los ejercicios resueltos, puntuaciones, etc.\");if(confirmed){AuthService.eraseStats().then(function(){setShowMessage(true);setTimeout(function(){setRedirect(true);},3000);}).catch(function(error){return console.error(\"Error borrando las estadísticas:\",error);});}};var handleDeleteAccount=function handleDeleteAccount(){var confirmed=window.confirm(\"¿Estás seguro? Esta acción no se puede deshacer.\");if(confirmed){AuthService.deleteAccount().then(function(){setShowMessage(true);setTimeout(function(){setRedirect(true);},3000);}).catch(function(error){return console.error(\"Error borrando la cuenta:\",error);});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"profile-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Datos del perfil\"}),/*#__PURE__*/_jsx(\"header\",{className:\"jumbotron\",children:content===\"Logged\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Email,{email:currentUser.email}),/*#__PURE__*/_jsx(Roles,{roles:currentUser.roles})]}):/*#__PURE__*/_jsx(_Fragment,{children:content})})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"config-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Configuraci\\xF3n\"}),content===\"Logged\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-custom btn-block\",onClick:handleEraseStats,children:\"Borrar Estad\\xEDsticas\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-block\",onClick:handleDeleteAccount,children:\"Borrar Cuenta\"}),showMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"input-feedback alert alert-success text-center\",children:\"\\xA1Las estad\\xEDsticas han sido borradas!\"}),redirect&&/*#__PURE__*/_jsx(Redirect,{to:\"/register\"})]}):/*#__PURE__*/_jsx(_Fragment,{children:content})]})]});};export default Profile;","map":{"version":3,"names":["React","useState","useEffect","Redirect","UserService","EventBus","Email","Roles","AuthService","Profile","content","setContent","showMessage","setShowMessage","redirect","setRedirect","currentUser","getCurrentUser","getUserBoard","then","response","error","_content","data","message","toString","status","dispatch","handleEraseStats","confirmed","window","confirm","eraseStats","setTimeout","catch","console","handleDeleteAccount","deleteAccount","email","roles"],"sources":["C:/Users/jaime/TFGProto/newfront/src/components/Profile/Profile.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport UserService from \"../../services/user.service\";\nimport EventBus from \"../../common/EventBus\";\nimport Email from \"./Email\";\nimport Roles from \"./Roles\";\nimport \"../../styles/Profile/Profile.css\";\nimport AuthService from \"../../services/auth.service\";\n\nconst Profile = () => {\n  const [content, setContent] = useState();\n  const [showMessage, setShowMessage] = useState(false);\n  const [redirect, setRedirect] = useState(false);\n  const currentUser = AuthService.getCurrentUser();\n\n  useEffect(() => {\n    UserService.getUserBoard().then(\n      (response) => {\n        setContent(\"Logged\");\n      },\n      (error) => {\n        const _content =\n          (error.response &&\n            error.response.data &&\n            error.response.data.message) ||\n          error.message ||\n          error.toString();\n\n        setContent(_content);\n\n        if (error.response && error.response.status === 401) {\n          EventBus.dispatch(\"logout\");\n        }\n      }\n    );\n  }, []);\n\n  const handleEraseStats = () => {\n    const confirmed = window.confirm(\n      \"¿Estás seguro? Se borrarán los ejercicios resueltos, puntuaciones, etc.\"\n    );\n    if (confirmed) {\n      AuthService.eraseStats()\n        .then(() => {\n          setShowMessage(true);\n          setTimeout(() => {\n            setRedirect(true);\n          }, 3000);\n        })\n        .catch((error) => console.error(\"Error borrando las estadísticas:\", error));\n    }\n  };\n\n  const handleDeleteAccount = () => {\n    const confirmed = window.confirm(\"¿Estás seguro? Esta acción no se puede deshacer.\");\n    if (confirmed) {\n      AuthService.deleteAccount()\n        .then(() => {\n          setShowMessage(true);\n          setTimeout(() => {\n            setRedirect(true);\n          }, 3000);\n        })\n        .catch((error) => console.error(\"Error borrando la cuenta:\", error));\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <section className=\"profile-section\">\n        <h2>Datos del perfil</h2>\n        <header className=\"jumbotron\">\n          {content === \"Logged\" ? (\n            <>\n              <Email email={currentUser.email} />\n              <Roles roles={currentUser.roles} />\n            </>\n          ) : (\n            <>{content}</>\n          )}\n        </header>\n      </section>\n\n      <section className=\"config-section\">\n        <h2>Configuración</h2>\n        {content === \"Logged\" ? (\n          <>\n            <button\n              className=\"btn btn-custom btn-block\"\n              onClick={handleEraseStats}\n            >\n              Borrar Estadísticas\n            </button>\n            <button\n              className=\"btn btn-danger btn-block\"\n              onClick={handleDeleteAccount}\n            >\n              Borrar Cuenta\n            </button>\n            {showMessage && (\n              <div className=\"input-feedback alert alert-success text-center\">\n                ¡Las estadísticas han sido borradas!\n              </div>\n            )}\n            {redirect && <Redirect to=\"/register\" />}\n          </>\n        ) : (\n          <>{content}</>\n        )}\n      </section>\n    </div>\n  );\n};\n\nexport default Profile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}